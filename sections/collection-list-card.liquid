{%- liquid
  assign section_title = section.settings.section_title
  assign section_subtitle = section.settings.section_subtitle
  assign columns_on_mobile_collection = section.settings.columns_on_mobile_collection
  assign link_text = section.settings.link_text
  assign link_url = section.settings.link_url
  assign color_scheme = section.settings.color_scheme


  assign block_count = section.blocks.size

  assign mobile_grid_item_width = 95 | divided_by: columns_on_mobile_collection
-%}

<style>
  #collection-list-card-{{ section.id }} {
    --color-scheme: {{ color_scheme }};
  }

   .collection-list-card {
     --cl-cols-mobile: {{ columns_on_mobile_collection }};
     --cl-mobile-grid-item-width: {{ mobile_grid_item_width }}%;
     padding-top: 50px;
     padding-bottom: 50px;
   }

   .collection-list-card__header {
     text-align: {{ section.settings.text_alignment | default: 'center' }};
     margin-bottom: 40px;
   }

   .collection-list-card__title {
     text-transform: uppercase;
     font-weight: 700;
     line-height: 100%;
     font-size: 32px;
     letter-spacing: 0%;
     margin: 0 0 8px 0;
     color: var(--color-foreground-heading);
   }

   .collection-list-card__subtitle {
    font-family: 'ButlerPro';
     font-size: 16px;
     font-weight: 400;
     line-height: 150%;
     margin: 0;
   }

   .collection-list-card__grid {
     display: grid;
     grid-template-columns: repeat({{ block_count }}, 1fr);
     gap: 30px;
   }

   .collection-list-card__item-content {
     text-align: center;
     margin-top: 24px;
   }

   .collection-list-card__item-image {
     width: 100%;
     height: auto;
     display: block;
   }

   .collection-list-card__item-title {
     font-size: 16px;
     text-transform: uppercase;
     letter-spacing: 0%;
     line-height: 120%;
     font-weight: 700;
     margin: 0 0 8px 0;
   }

   .collection-list-card__item-link {
     font-size: 14px;
     color: inherit;
     text-decoration: underline;
     text-transform: uppercase;
     letter-spacing: -1%;
     text-underline-offset: 4px;
     transition: opacity 0.2s ease-in-out;
   }

   .collection-list-card__item-link:hover {
     opacity: 0.7;
   }

   .collection-list-card__footer {
       text-align: center;
       margin-top: 20px;
   }

   .collection-list_button {
       margin-left: auto;
       border: none;
       text-transform: uppercase;
       font-size: 14px;
       margin-right: auto;
   }

   /* Mobile */
  @media (max-width: 768px) {
     .collection-list-card__slider-wrapper {
         margin: 0 -15px;
         padding-left: 16px;
     }

     .collection-list-card__grid {
       grid-template-columns: none;

       grid-auto-flow: column;
       overflow-x: auto;
       scroll-snap-type: x mandatory;
       scrollbar-width: none;
       -ms-overflow-style: none;
       gap: 8px;
       padding: 0 15px;
       grid-auto-columns: calc(var(--cl-mobile-grid-item-width) - 15px + (15px / var(--cl-cols-mobile)));
     }

     .collection-list-card__grid::-webkit-scrollbar {
         display: none;
     }

     .collection-list-card__item {
       scroll-snap-align: start;
     }

     .collection-list-card__title { font-size: 20px; line-height: 120%; }
     .collection-list-card__subtitle { font-size: 14px; line-height: 150%; }
     .collection-list-card__item-title { font-size: 16px; line-height: 120%; }
     .collection-list-card__item-link { font-size: 14px; line-height: 120%; letter-spacing: 0%; }
     .collection-list-card__header { margin-bottom: 24px; }
     .collection-list-card__item-content { margin-top: 16px; }
  }
</style>

<div id="collection-list-card-{{ section.id }}" class="color-{{ color_scheme }}">
  <div class="section collection-list-card">
    <div class="page-width">
      <div class="collection-list-card__header">
        {%- if section_title != blank -%}
          <h2 class="collection-list-card__title">{{ section_title }}</h2>
        {%- endif -%}
        {%- if section_subtitle != blank -%}
          <p class="collection-list-card__subtitle">{{ section_subtitle }}</p>
        {%- endif -%}
      </div>
    </div>


    <div class="collection-list-card__slider-wrapper">
      <div class="collection-list-card__grid">
        {%- for block in section.blocks -%}
          <div class="collection-list-card__item" {{ block.shopify_attributes }}>
            <a href="{{ block.settings.link_url }}">
              {%- if block.settings.image != blank -%}
                <img
                  class="collection-list-card__item-image"
                  src="{{ block.settings.image | image_url: width: 400 }}"
                  alt="{{ block.settings.image.alt | default: block.settings.title | escape }}"
                  width="400"
                  height="{{ 400 | divided_by: block.settings.image.aspect_ratio | round }}"
                  loading="lazy"
                >
              {%- else -%}
                {{ 'image' | placeholder_svg_tag: 'placeholder-svg' }}
              {%- endif -%}
            </a>
            <div class="collection-list-card__item-content">
              {%- if block.settings.title != blank -%}
                <h3 class="collection-list-card__item-title">{{ block.settings.title }}</h3>
              {%- endif -%}
              {%- if block.settings.link_text != blank and block.settings.link_url != blank -%}
                <a href="{{ block.settings.link_url }}" class="collection-list-card__item-link">
                  {{ block.settings.link_text }}
                </a>
              {%- endif -%}
            </div>
          </div>
        {%- else -%}
          {%- for i in (1..4) -%}
            <div class="collection-list-card__item">
              {{ 'image' | placeholder_svg_tag: 'placeholder-svg' }}
              <div class="collection-list-card__item-content">
                <h3 class="collection-list-card__item-title">Collection Title</h3>
                <a href="#" class="collection-list-card__item-link">Shop The Looks</a>
              </div>
            </div>
          {%- endfor -%}
        {%- endfor -%}
      </div>
    </div>

    {%- if link_text != blank and link_url != blank -%}
      <div class="page-width">
        <div class="collection-list-card__footer">
          <a href="{{ link_url }}" class="button collection-list_button">{{ link_text }}</a>
        </div>
      </div>
    {%- endif -%}
  </div>
</div>

{% schema %}
{
  "name": "Collection List (Cards)",
  "tag": "section",
  "class": "section section--full-width",
  "settings": [
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "Color Scheme",
      "default": "scheme-1"
    },
    {
      "type": "header",
      "content": "Content settings"
    },
    {
      "type": "select",
      "id": "text_alignment",
      "label": "Section title alignment",
      "default": "center",
      "options": [
        { "value": "left", "label": "Left" },
        { "value": "center", "label": "Center" },
        { "value": "right", "label": "Right" }
      ]
    },
    {
      "type": "text",
      "id": "section_title",
      "label": "Section title",
      "default": "New Season Trends"
    },
    {
      "type": "text",
      "id": "section_subtitle",
      "label": "Section subtitle",
      "default": "Get ready for the spring!"
    },
    {
      "type": "select",
      "id": "columns_on_mobile_collection",
      "label": "Columns (mobile)",
      "options": [
        { "value": "1", "label": "One" },
        { "value": "2", "label": "Two" }
      ],
      "default": "2"
    },
    {
      "type": "text",
      "id": "link_text",
      "label": "Link text",
      "default": "Discover All"
    },
    {
      "type": "url",
      "id": "link_url",
      "label": "Link URL"
    }
  ],
  "blocks": [
    {
      "type": "collection_card",
      "name": "Collection Card",
      "limit": 4,
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Title",
          "default": "Western Chic"
        },
        {
          "type": "text",
          "id": "link_text",
          "label": "Link text",
          "default": "Shop The Looks"
        },
        {
          "type": "url",
          "id": "link_url",
          "label": "Link URL",
          "info": "Both the image and the link text will point to this URL."
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Collection List (Cards)",
      "blocks": [
        { "type": "collection_card" },
        { "type": "collection_card" },
        { "type": "collection_card" },
        { "type": "collection_card" }
      ]
    }
  ]
}
{% endschema %}