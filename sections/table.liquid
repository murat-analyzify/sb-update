{%- style -%}
    #shopify-section-{{ section.id }} .table-heading {
      font-size: {{ section.settings.heading_size }}px;
    }

    .table-heading {
      margin-bottom: 2rem;
    }

    .text-left {
      text-align: left;
    }

    .text-center {
      text-align: center;
    }

    .text-right {
      text-align: right;
    }

    .custom-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 1rem;
    }

    .custom-table th,
    .custom-table td {
      padding: 0.5rem;
      text-align: left;
      border-bottom: 1px solid rgba(var(--color-foreground), 0.1);
    }

    .custom-table th {
      font-weight: bold;
    }

    .custom-table tr:last-child td {
      border-bottom: none;
    }

    .custom-table thead {
        background-color: var(--table-thead-bg, #F2F0F0);
    }

    /* Hide mobile view by default on larger screens */
    .mobile-view-wrapper {
      display: none;
    }


    /* --- Media Query for Mobile --- */
    @media screen and (max-width: 749px) {
      .desktop-table-wrapper {
          display: none;
      }

      .mobile-view-wrapper {
          display: block;
      }

      .mobile-pricing-header {
          background-color: rgba(var(--color-foreground), 0.05);
          padding: 1.2rem;
          text-align: center;
          font-weight: 600;
          margin-bottom: 2rem;
          border-radius: var(--buttons-radius-outset, 0px);
      }

      .mobile-row-block {
          padding-bottom: 1.5rem;
          margin-bottom: 1.5rem;
          border-bottom: 1px solid rgba(var(--color-foreground), 0.1);
      }

      .mobile-row-block:last-child {
          border-bottom: none;
          margin-bottom: 0;
          padding-bottom: 0;
      }

      .mobile-row-title {
          font-weight: bold;
          font-size: 1.8rem;
          margin: 0 0 1rem 0;
      }
    
      .mobile-cost-item {
          display: flex;
          justify-content: space-between;
          align-items: center;
          font-size: 1.6rem;
          padding: 0.5rem 0;
      }
    }

    .section-{{ section.id }}-padding {
      padding-top: {{ section.settings.padding_top }}px;
      padding-bottom: {{ section.settings.padding_bottom }}px;
    }

    @media screen and (max-width: 749px) {
      .section-{{ section.id }}-padding {
        padding-top: {{ section.settings.padding_top_mobile }}px;
        padding-bottom: {{ section.settings.padding_bottom_mobile }}px;
      }
    }

    {%- liquid
      assign number_of_columns = section.settings.number_of_columns
      for i in (1..number_of_columns)
        assign col_width_setting = 'col_' | append: i | append: '_width'
        assign col_width = section.settings[col_width_setting]

        echo '#shopify-section-' | append: section.id | append: ' .custom-table th:nth-child(' | append: i | append: '), '
        echo '#shopify-section-' | append: section.id | append: ' .custom-table td:nth-child(' | append: i | append: ') { '
        echo 'width: ' | append: col_width | append: '%; }'
      endfor
    -%}
{%- endstyle -%}

<div class="color-{{ section.settings.color_scheme }} gradient section-{{ section.id }}-padding">
  <div class="page-width">
    {%- if section.settings.table_heading != blank -%}
      <h2 class="table-heading text-{{ section.settings.heading_alignment }}">
        {{ section.settings.table_heading }}
      </h2>
    {%- endif -%}

    <!-- Desktop Table -->
    <div class="desktop-table-wrapper">
      <table class="custom-table">
        <thead>
          <tr>
            {%- for i in (1..section.settings.number_of_columns) -%}
              {%- assign col_head_setting = 'col_' | append: i | append: '_head' -%}
              {%- assign col_head_content = section.settings[col_head_setting] -%}
              <th>{{ col_head_content }}</th>
            {%- endfor -%}
          </tr>
        </thead>
        <tbody>
          {%- for block in section.blocks -%}
            <tr {{ block.shopify_attributes }}>
              {%- for i in (1..section.settings.number_of_columns) -%}
                {%- assign col_data_setting = 'col_' | append: i | append: '_data' -%}
                {%- assign col_data_content = block.settings[col_data_setting] -%}
                <td>{{ col_data_content }}</td>
              {%- endfor -%}
            </tr>
          {%- endfor -%}
        </tbody>
      </table>
    </div>

    <!-- Mobile View -->
    <div class="mobile-view-wrapper">
      {%- if section.settings.col_1_head != blank -%}
        <div class="mobile-pricing-header">
          {{ section.settings.col_1_head }}
        </div>
      {%- endif -%}
      <div class="mobile-rows-container">
        {%- for block in section.blocks -%}
          <div class="mobile-row-block" {{ block.shopify_attributes }}>
            <p class="mobile-row-title">{{ block.settings.col_1_data }}</p>
            <div class="mobile-row-costs">
              {%- if section.settings.number_of_columns >= 2 and block.settings.col_2_data != blank -%}
                <div class="mobile-cost-item">
                  <span>{{ section.settings.col_2_head }}:</span>
                  <span>{{ block.settings.col_2_data }}</span>
                </div>
              {%- endif -%}
              {%- if section.settings.number_of_columns >= 3 and block.settings.col_3_data != blank -%}
                <div class="mobile-cost-item">
                  <span>{{ section.settings.col_3_head }}:</span>
                  <span>{{ block.settings.col_3_data }}</span>
                </div>
              {%- endif -%}
               {%- if section.settings.number_of_columns >= 4 and block.settings.col_4_data != blank -%}
                <div class="mobile-cost-item">
                  <span>{{ section.settings.col_4_head }}:</span>
                  <span>{{ block.settings.col_4_data }}</span>
                </div>
              {%- endif -%}
            </div>
          </div>
        {%- endfor -%}
      </div>
    </div>
  </div>
</div>

{% schema %}
  {
    "name": "Table",
    "tag": "section",
    "class": "section",
    "settings": [
      {
        "type": "color_scheme",
        "id": "color_scheme",
        "label": "Color scheme",
        "default": "scheme-1"
      },
      {
        "type": "range",
        "id": "number_of_columns",
        "min": 1,
        "max": 4,
        "step": 1,
        "label": "Number of columns",
        "default": 3
      },
      {
        "type": "header",
        "content": "Columns width desktop"
      },
      {
        "type": "range",
        "id": "col_1_width",
        "min": 10,
        "max": 100,
        "step": 1,
        "unit": "%",
        "label": "Column 1 width",
        "default": 28
      },
      {
        "type": "range",
        "id": "col_2_width",
        "min": 10,
        "max": 100,
        "step": 1,
        "unit": "%",
        "label": "Column 2 width",
        "default": 24
      },
      {
        "type": "range",
        "id": "col_3_width",
        "min": 10,
        "max": 100,
        "step": 1,
        "unit": "%",
        "label": "Column 3 width",
        "default": 24
      },
      {
        "type": "range",
        "id": "col_4_width",
        "min": 10,
        "max": 100,
        "step": 1,
        "unit": "%",
        "label": "Column 4 width",
        "default": 24
      },
      {
        "type": "paragraph",
        "content": "Ensure the sum of all column widths is 100% to avoid layout issues."
      },
      {
        "type": "header",
        "content": "Table Heading"
      },
      {
        "type": "text",
        "id": "table_heading",
        "label": "Table heading",
        "default": "Ski Tuning Service"
      },
      {
        "type": "range",
        "id": "heading_size",
        "min": 20,
        "max": 60,
        "step": 1,
        "unit": "px",
        "label": "Heading size",
        "default": 32
      },
      {
        "type": "radio",
        "id": "heading_alignment",
        "label": "Heading alignment",
        "options": [
          { "value": "left", "label": "Left" },
          { "value": "center", "label": "Center" },
          { "value": "right", "label": "Right" }
        ],
        "default": "center"
      },
      {
        "type": "header",
        "content": "Table Heads Data"
      },
      {
        "type": "text",
        "id": "col_1_head",
        "label": "Column 1 - head data",
        "default": "Pricing"
      },
      {
        "type": "text",
        "id": "col_2_head",
        "label": "Column 2 - head data",
        "default": "Cost with Purchase*"
      },
      {
        "type": "text",
        "id": "col_3_head",
        "label": "Column 3 - head data",
        "default": "Cost without Purchase"
      },
      {
        "type": "text",
        "id": "col_4_head",
        "label": "Column 4 - head data",
        "default": "Head content"
      },
      {
        "type": "header",
        "content": "Section padding - desktop"
      },
      {
        "type": "range",
        "id": "padding_top",
        "min": 0,
        "max": 100,
        "step": 4,
        "unit": "px",
        "label": "Top padding",
        "default": 80
      },
      {
        "type": "range",
        "id": "padding_bottom",
        "min": 0,
        "max": 100,
        "step": 4,
        "unit": "px",
        "label": "Bottom padding",
        "default": 16
      },
      {
        "type": "header",
        "content": "Section padding - mobile"
      },
      {
        "type": "range",
        "id": "padding_top_mobile",
        "min": 0,
        "max": 100,
        "step": 4,
        "unit": "px",
        "label": "Top padding",
        "default": 48
      },
      {
        "type": "range",
        "id": "padding_bottom_mobile",
        "min": 0,
        "max": 100,
        "step": 4,
        "unit": "px",
        "label": "Bottom padding",
        "default": 16
      }
    ],
    "blocks": [
      {
        "type": "row",
        "name": "Row",
        "settings": [
          {
            "type": "text",
            "id": "col_1_data",
            "label": "Column 1 - row data"
          },
          {
            "type": "text",
            "id": "col_2_data",
            "label": "Column 2 - row data"
          },
          {
            "type": "text",
            "id": "col_3_data",
            "label": "Column 3 - row data"
          },
          {
            "type": "text",
            "id": "col_4_data",
            "label": "Column 4 - row data"
          }
        ]
      }
    ],
    "presets": [
      {
        "name": "Table",
        "blocks": [
          {
            "type": "row",
            "settings": {
                "col_1_data": "New Alpine Ski Binding Mount & Test",
                "col_2_data": "FREE",
                "col_3_data": "$75",
                "col_4_data": "Row data"
            }
          },
          {
            "type": "row",
            "settings": {
                "col_1_data": "Alpine Ski Binding Remount / Test",
                "col_2_data": "FREE",
                "col_3_data": "$65",
                "col_4_data": "Row data"
            }
          },
          {
            "type": "row",
            "settings": {
                "col_1_data": "System Binding Mount /Test",
                "col_2_data": "FREE",
                "col_3_data": "$45",
                "col_4_data": "Row data"
            }
          }
        ]
      }
    ]
  }
{% endschema %}